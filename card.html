<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Business Card</title>
    <!-- Font Awesome for icons -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      rel="stylesheet"
    />
    <!-- EmailJS Library -->
    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <style>
      :root {
        --primary-color: #1e1e1e;
        --secondary-color: #1e90ff;
        --accent-color: #ff5722;
        --golden: rgba(218, 165, 32, 0.8);
        --neutral-light: rgba(245,245,245,0.9);
        --neutral-dark: #333;
        --card-background: #fff;
        --body-bg: linear-gradient(135deg, #cfd8dc, #eceff1);
        --business-info-bg: #e0f7fa;
        /* We use fixed side padding in the offers container */
        --offers-side-padding: 0.02in; /* about 0.5 mm */
      }
      body {
        font-family: 'Segoe UI', sans-serif;
        margin: 0;
        padding: 1rem;
        background: var(--body-bg);
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
      }
      .card-container {
        width: 90%;
        max-width: 600px;
        background: var(--card-background);
        border-radius: 20px;
        border: 2px solid transparent;
        border-image: linear-gradient(45deg, var(--secondary-color), var(--accent-color), #3f51b5) 1;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
        padding: 1.5rem;
        margin: 1rem auto;
        overflow: hidden;
      }
      /* Standardize header sections (settings, share, mini icons, profile) – unchanged */
      #styleControlsContainer {
        position: absolute;
        top: 10px;
        left: 10px;
        z-index: 10;
      }
      #styleButton {
        padding: 0.5rem;
        font-size: 1.2rem;
        border: none;
        background: none;
        cursor: pointer;
        color: blue;
      }
      #styleButton:hover { color: var(--secondary-color); }
      .top-icons {
        position: absolute;
        top: 10px;
        right: 10px;
        z-index: 10;
      }
      .top-share-icon {
        padding: 0.5rem;
        font-size: 1.2rem;
        border: none;
        background: none;
        cursor: pointer;
        color: blue;
      }
      .top-share-icon:hover { color: var(--secondary-color); }
      /* Dropdown, mini icons, profile, etc. – unchanged */
      /* ... [For brevity, these sections remain similar as before] ... */
      /* Offers Section Container – new standardized container */
      .offers-section {
        margin: 1rem 0;
        padding: 1rem 0;
        border: 1px dashed var(--neutral-light);
        border-radius: 10px;
        position: relative;
        /* Use fixed width (100% of card-container) and minimal side padding */
        box-sizing: border-box;
      }
      .offers-inner-container {
        width: 100%;
        padding: 0  var(--offers-side-padding);
        overflow: hidden;
      }
      /* Blinking Banner – placed at top-right of offers container */
      .exclusive-offer-banner {
        position: absolute;
        top: -1rem;
        right: 1rem;
        padding: 0.2rem 0.5rem;
        border: 2px solid var(--golden);
        border-radius: 8px;
        background: var(--golden);
        color: var(--neutral-dark);
        font-weight: bold;
        font-size: 0.8rem;
        z-index: 10;
      }
      /* Auto-scroll track using Flexbox */
      .flip-cards-container {
        overflow: hidden;
        position: relative;
        margin-top: 1.2rem;
      }
      .flip-cards-track {
        display: flex;
        gap: 0.08in; /* 2mm gap */
        animation: scrollCards 20s linear infinite;
      }
      @keyframes scrollCards {
        0% { transform: translateX(0); }
        100% { transform: translateX(-50%); }
      }
      /* Flip Card Styles */
      .flip-card {
        width: 1.5in;
        height: 2in;
        perspective: 1000px;
        flex-shrink: 0;
        cursor: pointer;
        background: transparent;
      }
      .flip-card-inner {
        width: 100%;
        height: 100%;
        transition: transform 0.6s;
        transform-style: preserve-3d;
      }
      .flip-card:hover { box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
      .flip-card.flipped .flip-card-inner { transform: rotateY(180deg); }
      .flip-card-face {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        border-radius: 6px;
        box-sizing: border-box;
        padding: 0.1in;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        overflow: hidden;
      }
      .flip-card-front {
        font-size: 0.25in;
        color: #fff;
      }
      .flip-card-front img {
        max-width: 100%;
        max-height: 40%;
        margin-bottom: 0.05in;
      }
      .flip-card-back {
        background: var(--accent-color);
        color: #fff;
        transform: rotateY(180deg);
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .more-details-btn {
        background: #fff;
        color: var(--accent-color);
        padding: 0.1in 0.2in;
        border: none;
        border-radius: 4px;
        font-size: 0.2in;
        cursor: pointer;
      }
      .remove-bg-btn {
        background: #fff;
        color: var(--secondary-color);
        padding: 0.05in 0.1in;
        border: none;
        border-radius: 4px;
        font-size: 0.18in;
        cursor: pointer;
        margin-top: 0.05in;
      }
      /* Other sections (Business Info, Action Buttons, Social Links, Floating Chat) remain similar */
      .business-info-section {
        padding: 1rem;
        margin: 0.5rem;
        font-size: 0.9rem;
        line-height: 1.5;
        height: 150px;
        overflow: hidden;
        background: var(--business-info-bg);
        border-bottom: 2px solid var(--secondary-color);
        border-radius: 20px;
        position: relative;
        font-family: "Georgia", serif;
      }
      .action-buttons {
        display: grid;
        gap: 0.5rem;
        padding: 0.8rem;
      }
      .floating-chat-btn {
        position: absolute;
        bottom: 20px;
        right: 20px;
        background: var(--secondary-color);
        color: #fff;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        cursor: pointer;
        font-size: 1.5rem;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        transition: transform 0.3s, box-shadow 0.3s;
      }
      .floating-chat-btn:hover {
        background: var(--accent-color);
        transform: scale(1.1);
      }
    </style>
  </head>
  <body>
    <div class="card-container" id="cardContainer">
      <!-- (Settings, Share, Mini Icons, Profile sections remain unchanged) -->
      <!-- … [Omitted for brevity; same as before] … -->
      <!-- Offers Section -->
      <div class="offers-section" id="offersFlipCardSection">
        <div class="exclusive-offer-banner">Grab Your Exclusive Offer</div>
        <div class="offers-inner-container">
          <div class="flip-cards-container">
            <div class="flip-cards-track" id="flipCardsTrack">
              <!-- Flip cards will be rendered here (duplicated for seamless scrolling) -->
            </div>
          </div>
        </div>
      </div>
      <!-- Business Info, Action Buttons, Social Links, Floating Chat remain unchanged -->
      <!-- … [Omitted for brevity] … -->
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const storedData = localStorage.getItem("formData");
        const formData = storedData ? JSON.parse(storedData) : {};
        // (Profile population and Business Info setup remain as before)
        // Social Links
        const socialLinks = {
          facebook: document.getElementById("facebookButton"),
          instagram: document.getElementById("instagramButton"),
          youtube: document.getElementById("youtubeButton")
        };
        Object.entries(socialLinks).forEach(([platform, element]) => {
          const url = formData[platform];
          if(url){
            element.href = url;
            element.style.visibility = "visible";
            element.target = "_blank";
          } else {
            element.style.visibility = "hidden";
          }
        });
        // Render Offers if offerStyle is "horizontal"
        if(formData.offers && formData.offerStyle === "horizontal"){
          renderFlipCards(formData.offers);
        }
      });
      // Preset background colors
      const cardColors = ["#1abc9c", "#3498db", "#9b59b6", "#e67e22", "#e74c3c", "#2ecc71", "#f1c40f", "#34495e"];
      // Render flip cards with duplication for seamless scrolling
      function renderFlipCards(offers) {
        const track = document.getElementById("flipCardsTrack");
        let cardsHTML = "";
        offers.forEach((offer, index) => {
          const snippet = offer.details ? offer.details.substring(0,50) + "..." : "";
          const cardHTML = `
            <div class="flip-card" onclick="this.classList.toggle('flipped')">
              <div class="flip-card-inner">
                <div class="flip-card-face flip-card-front" style="background: ${cardColors[index % cardColors.length]};">
                  <div style="overflow:hidden; text-overflow:ellipsis; white-space:nowrap; width:100%;">
                    <strong>${offer.title || "Offer " + (index+1)}</strong>
                  </div>
                  <div style="font-size:0.18in; margin-top:0.05in;">${snippet}</div>
                  ${offer.file ? `<img src="${offer.file}" alt="Offer Image" />
                  <button class="remove-bg-btn" onclick="event.stopPropagation(); this.previousElementSibling.style.background='none';">Remove BG</button>` : ""}
                </div>
                <div class="flip-card-face flip-card-back">
                  <button class="more-details-btn" onclick="event.stopPropagation(); openOfferDetails(${index});">More Details</button>
                </div>
              </div>
            </div>
          `;
          cardsHTML += cardHTML;
        });
        // Duplicate content for seamless scrolling
        track.innerHTML = cardsHTML + cardsHTML;
      }
      function openOfferDetails(index) {
        window.location.href = "offerDetails.html?offer=" + index;
      }
      function openWhatsAppChat() {
        window.open("https://wa.me/1234567890", "_blank");
      }
      // Dropdown toggle code remains unchanged
      document.addEventListener("click", function(e) {
        if (!document.getElementById("styleControlsContainer").contains(e.target))
          document.getElementById("styleDropdown").style.display = "none";
      });
      document.getElementById("styleButton").addEventListener("click", function(e) {
        e.stopPropagation();
        const dd = document.getElementById("styleDropdown");
        dd.style.display = dd.style.display === "block" ? "none" : "block";
      });
    </script>
  </body>
</html>
