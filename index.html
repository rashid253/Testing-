<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Business Card Generator</title>
  <!-- Font Awesome for icons -->
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    rel="stylesheet"
  />
  <!-- intl-tel-input CSS -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css"
  />
  <style>
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #3498db;
      --accent-color: #e74c3e;
      --neutral-light: rgba(236, 240, 241, 0.9);
      --neutral-dark: #34495e;
      --background-color: #ffffff;
    }
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 1rem;
      background: var(--background-color);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .form-container {
      width: 100%;
      max-width: 450px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.12);
      padding: 1.5rem;
      position: relative;
    }
    .gear-icon {
      position: absolute;
      top: -10px;
      right: 1rem;
      font-size: 1.5rem;
      color: var(--primary-color);
      cursor: pointer;
    }
    .form-header {
      text-align: center;
      color: var(--primary-color);
      margin-bottom: 1rem;
    }
    .form-grid {
      display: grid;
      gap: 1rem;
    }
    /* Dropdown menu and submenus */
    .dropdown-menu {
      position: absolute;
      top: 3rem;
      right: 0;
      background: #fff;
      border: 1px solid var(--neutral-light);
      border-radius: 8px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
      padding: 0.5rem;
      width: 80px;
      text-align: center;
      display: none;
      z-index: 1000;
    }
    .dropdown-menu.active {
      display: block;
    }
    .dropdown-menu h4,
    .dropdown-menu button {
      margin: 0.3rem 0;
      padding: 0.3rem;
      border: 1px solid var(--neutral-light);
      border-radius: 4px;
      background: var(--secondary-color);
      color: #fff;
      cursor: pointer;
    }
    .dropdown-menu h4:hover,
    .dropdown-menu button:hover {
      background: var(--accent-color);
    }
    .sub-dropdown {
      display: none;
      margin-top: 0.3rem;
    }
    .sub-dropdown.active {
      display: block;
    }
    /* Preview areas (positioned to the left of the dropdown) */
    .preview-area {
      position: absolute;
      left: -120px;
      top: 0;
      width: 100px;
      height: 100px;
      border: 2px solid var(--secondary-color);
      border-radius: 4px;
      display: none;
      text-align: center;
      line-height: 100px;
      font-weight: bold;
      background: #fff;
    }
    .action-buttons {
      position: absolute;
      left: -120px;
      top: 110px;
      display: none;
    }
    .action-buttons button {
      padding: 0.3rem;
      margin: 0 5px;
      border: none;
      border-radius: 4px;
      background: var(--secondary-color);
      color: #fff;
      cursor: pointer;
      font-size: 0.8rem;
    }
    /* Scrollable thumbnail bars */
    .thumbnail-bar {
      display: flex;
      gap: 0.3rem;
      overflow-x: auto;
      margin-bottom: 0.3rem;
    }
    .thumbnail-bar img,
    .thumbnail-bar div {
      width: 25px;
      height: 25px;
      border-radius: 4px;
      cursor: pointer;
      border: 1px solid transparent;
      transition: border-color 0.2s ease;
    }
    .thumbnail-bar img:hover,
    .thumbnail-bar div:hover {
      border-color: var(--secondary-color);
    }
    /* Simple input groups (for brevity, only some are shown) */
    .input-group { display: flex; flex-direction: column; }
  </style>
</head>
<body>
  <div class="form-container" id="formContainer">
    <div class="gear-icon" onclick="toggleDropdown()">
      <i class="fas fa-cog"></i>
    </div>
    <div class="dropdown-menu" id="dropdownMenu">
      <!-- Mood section -->
      <h4 onclick="toggleSubDropdown('mood')">Mood</h4>
      <div id="moodSubDropdown" class="sub-dropdown">
        <button onclick="selectMood('day', this)">Day</button>
        <button onclick="selectMood('night', this)">Night</button>
        <!-- The Apply button appears as the third button -->
        <button onclick="applySelectedMood()">Apply</button>
      </div>
      <!-- Style section -->
      <h4 onclick="toggleSubDropdown('style')">Style</h4>
      <div id="styleSubDropdown" class="sub-dropdown">
        <button onclick="selectStyle('default', this)">Default</button>
        <button onclick="selectStyle('styleA', this)">Style A</button>
        <button onclick="selectStyle('styleB', this)">Style B</button>
        <button onclick="applySelectedStyle()">Apply</button>
      </div>
      <!-- Theme section -->
      <h4 onclick="toggleSubDropdown('theme')">Theme</h4>
      <div id="themeSubDropdown" class="sub-dropdown">
        <button onclick="previewThemeDefault()">Default</button>
        <button onclick="toggleSubDropdown('image')">Image</button>
        <div id="imageSubDropdown" class="sub-dropdown" style="position:relative;">
          <div class="thumbnail-bar" id="imageThumbnailBar">
            <img src="https://cdn.pixabay.com/photo/2015/04/23/22/00/tree-736885_1280.jpg" onclick="selectThemeImage(this.src, this)" />
            <img src="https://cdn.pixabay.com/photo/2015/12/01/20/28/road-1072821_1280.jpg" onclick="selectThemeImage(this.src, this)" />
            <img src="https://cdn.pixabay.com/photo/2016/05/05/02/37/sunset-1373171_1280.jpg" onclick="selectThemeImage(this.src, this)" />
            <img src="https://cdn.pixabay.com/photo/2018/08/21/23/29/forest-3622519_1280.jpg" onclick="selectThemeImage(this.src, this)" />
            <img src="https://cdn.pixabay.com/photo/2017/02/08/17/24/fantasy-2049567_1280.jpg" onclick="selectThemeImage(this.src, this)" />
          </div>
          <!-- When an image is selected, the thumbnail bar is replaced by a preview box and Apply button -->
          <div class="preview-area" id="themeImagePreviewArea"></div>
          <div class="action-buttons" id="themeImageActionButtons">
            <button onclick="applySelectedThemeImage()">Apply</button>
          </div>
        </div>
        <button onclick="toggleSubDropdown('color')">Color</button>
        <div id="colorSubDropdown" class="sub-dropdown" style="position:relative;">
          <div class="thumbnail-bar" id="colorThumbnailBar">
            <div style="background-color: #3498DB;" onclick="selectThemeColor('#3498DB', this)"></div>
            <div style="background-color: #E74C3E;" onclick="selectThemeColor('#E74C3E', this)"></div>
            <div style="background-color: #2ECC71;" onclick="selectThemeColor('#2ECC71', this)"></div>
            <div style="background-color: #9B59B6;" onclick="selectThemeColor('#9B59B6', this)"></div>
            <div style="background-color: #F1C40F;" onclick="selectThemeColor('#F1C40F', this)"></div>
          </div>
          <div class="preview-area" id="themeColorPreviewArea"></div>
          <div class="action-buttons" id="themeColorActionButtons">
            <button onclick="applySelectedThemeColor()">Apply</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Preview areas for Mood and Style (positioned to left of dropdown) -->
    <!-- They will appear when a selection is made -->
    <div class="preview-area" id="moodPreviewArea"></div>
    <div class="action-buttons" id="moodActionButtons">
      <button onclick="applySelectedMood()">Apply</button>
    </div>
    <div class="preview-area" id="stylePreviewArea"></div>
    <div class="action-buttons" id="styleActionButtons">
      <button onclick="applySelectedStyle()">Apply</button>
    </div>
    <div class="form-header">
      <h2>Create Business Card</h2>
      <p>Fill in all required information</p>
    </div>
    <div class="form-grid">
      <!-- Profile Image Upload Group -->
      <div class="image-upload-group">
        <label for="profileImage">
          <i class="fas fa-camera fa-2x"></i>
          <p>Upload Profile Photo</p>
        </label>
        <input type="file" id="profileImage" accept="image/*" onchange="previewImage(event)" />
        <img id="imagePreview" alt="Profile Preview" />
      </div>
      <!-- (Other input groups go here) -->
      <div class="input-group">
        <label for="name">Full Name <span class="required">*</span></label>
        <input type="text" id="name" placeholder="Full Name" required />
      </div>
      <div class="input-group">
        <label for="businessName">Business Name <span class="required">*</span></label>
        <input type="text" id="businessName" placeholder="Business Name" required />
      </div>
      <div class="input-group">
        <label for="businessInfo">Business Info <span class="required">*</span></label>
        <textarea id="businessInfo" placeholder="Enter 3 to 5 paragraphs (Max 150 words each)" rows="6" required></textarea>
      </div>
      <div class="input-group">
        <label for="address">Business Address <span class="required">*</span></label>
        <input type="text" id="address" placeholder="Business Address" required />
      </div>
      <div class="input-group">
        <label for="phone">Phone Number <span class="required">*</span></label>
        <input type="tel" id="phone" placeholder="Enter phone number" required />
      </div>
      <div class="input-group">
        <label for="email">Email Address <span class="required">*</span></label>
        <input type="email" id="email" placeholder="Email Address" required />
      </div>
    </div>
    <button id="generateCard">Generate Card</button>
  </div>
  <!-- Scripts -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js"></script>
  <script>
    // (Firebase configuration and phone input initialization code goes here)
    var firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_STORAGE_BUCKET",
      messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
      appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    var phoneInput = document.querySelector("#phone");
    var iti = window.intlTelInput(phoneInput, {
      initialCountry: "auto",
      separateDialCode: true,
      geoIpLookup: function(success) {
        fetch('https://ipinfo.io/json?token=YOUR_TOKEN')
          .then(resp => resp.json())
          .then(data => success(data.country))
          .catch(() => success("us"));
      },
      utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js"
    });
    function previewImage(event) {
      const reader = new FileReader();
      const preview = document.getElementById('imagePreview');
      reader.onload = function(e) {
        preview.src = e.target.result;
        preview.style.display = 'block';
      };
      reader.readAsDataURL(event.target.files[0]);
    }
    // (resizeImage and validateForm functions omitted for brevity)
    function toggleDropdown() {
      document.getElementById('dropdownMenu').classList.toggle('active');
    }
    function toggleSubDropdown(id) {
      const sub = document.getElementById(id + 'SubDropdown');
      sub.classList.toggle('active');
    }
    // ---- Mood functions ----
    let selectedMood = null;
    function selectMood(mood, element) {
      // Highlight button
      document.querySelectorAll('#moodSubDropdown button').forEach(btn => btn.style.borderColor = 'transparent');
      element.style.borderColor = "#3498DB";
      selectedMood = mood;
      const preview = document.getElementById('moodPreviewArea');
      preview.innerHTML = mood.toUpperCase();
      preview.style.display = 'block';
      document.getElementById('moodActionButtons').style.display = 'block';
    }
    function applySelectedMood() {
      if(selectedMood === 'day'){
        document.body.style.backgroundColor = '#ffffff';
        document.body.style.color = '#000000';
      } else if(selectedMood === 'night'){
        document.body.style.backgroundColor = '#000000';
        document.body.style.color = '#ffffff';
      }
      cancelSelectedMood();
    }
    function cancelSelectedMood() {
      selectedMood = null;
      document.getElementById('moodPreviewArea').style.display = 'none';
      document.getElementById('moodActionButtons').style.display = 'none';
      document.querySelectorAll('#moodSubDropdown button').forEach(btn => btn.style.borderColor = 'transparent');
    }
    // ---- Style functions ----
    let selectedStyle = null;
    function selectStyle(style, element) {
      document.querySelectorAll('#styleSubDropdown button').forEach(btn => btn.style.borderColor = 'transparent');
      element.style.borderColor = "#3498DB";
      selectedStyle = style;
      const preview = document.getElementById('stylePreviewArea');
      preview.innerHTML = style.toUpperCase();
      preview.style.display = 'block';
      document.getElementById('styleActionButtons').style.display = 'block';
    }
    function applySelectedStyle() {
      const form = document.getElementById('formContainer');
      if(selectedStyle === 'default'){
        form.style.borderRadius = '15px';
        form.style.boxShadow = '0 8px 30px rgba(0,0,0,0.12)';
      } else if(selectedStyle === 'styleA'){
        form.style.borderRadius = '0';
        form.style.boxShadow = 'none';
      } else if(selectedStyle === 'styleB'){
        form.style.borderRadius = '30px';
        form.style.boxShadow = '0 12px 40px rgba(0,0,0,0.2)';
      }
      cancelSelectedStyle();
    }
    function cancelSelectedStyle() {
      selectedStyle = null;
      document.getElementById('stylePreviewArea').style.display = 'none';
      document.getElementById('styleActionButtons').style.display = 'none';
      document.querySelectorAll('#styleSubDropdown button').forEach(btn => btn.style.borderColor = 'transparent');
    }
    // ---- Theme: Default ----
    function previewThemeDefault() {
      const preview = document.getElementById('themeImagePreviewArea');
      preview.innerHTML = 'DEFAULT';
      preview.style.display = 'block';
      document.getElementById('themeImageActionButtons').innerHTML = '<button onclick="applyThemeDefault()">Apply</button>';
      document.getElementById('themeImageActionButtons').style.display = 'block';
    }
    function applyThemeDefault() {
      const form = document.getElementById('formContainer');
      form.style.backgroundImage = 'none';
      form.style.backgroundColor = 'white';
      document.getElementById('themeImagePreviewArea').style.display = 'none';
      document.getElementById('themeImageActionButtons').style.display = 'none';
    }
    // ---- Theme: Image Selection ----
    let selectedThemeImage = null;
    function selectThemeImage(src, element) {
      document.querySelectorAll('#imageSubDropdown .thumbnail-bar img').forEach(img => img.style.borderColor = 'transparent');
      element.style.borderColor = "#3498DB";
      selectedThemeImage = src;
      const preview = document.getElementById('themeImagePreviewArea');
      preview.innerHTML = `<img src="${src}" style="width:100%; height:100%; object-fit:cover;">`;
      preview.style.display = 'block';
      document.getElementById('themeImageActionButtons').innerHTML = '<button onclick="applySelectedThemeImage()">Apply</button>';
      document.getElementById('themeImageActionButtons').style.display = 'block';
    }
    function applySelectedThemeImage() {
      if(selectedThemeImage){
        const form = document.getElementById('formContainer');
        form.style.backgroundImage = `url(${selectedThemeImage})`;
        form.style.backgroundSize = 'cover';
        cancelSelectedThemeImage();
      }
    }
    function cancelSelectedThemeImage() {
      selectedThemeImage = null;
      document.getElementById('themeImagePreviewArea').style.display = 'none';
      document.getElementById('themeImageActionButtons').style.display = 'none';
      document.querySelectorAll('#imageSubDropdown .thumbnail-bar img').forEach(img => img.style.borderColor = 'transparent');
    }
    // ---- Theme: Color Selection ----
    let selectedThemeColor = null;
    function selectThemeColor(color, element) {
      document.querySelectorAll('#colorSubDropdown .thumbnail-bar div').forEach(div => div.style.borderColor = 'transparent');
      element.style.borderColor = "#3498DB";
      selectedThemeColor = color;
      const preview = document.getElementById('themeColorPreviewArea');
      if(color.indexOf("linear-gradient") >= 0) {
        preview.style.background = color;
      } else {
        preview.style.backgroundColor = color;
      }
      preview.style.display = 'block';
      document.getElementById('themeColorActionButtons').innerHTML = '<button onclick="applySelectedThemeColor()">Apply</button>';
      document.getElementById('themeColorActionButtons').style.display = 'block';
    }
    function applySelectedThemeColor() {
      if(selectedThemeColor){
        const form = document.getElementById('formContainer');
        form.style.backgroundImage = 'none';
        if(selectedThemeColor.indexOf("linear-gradient") >= 0) {
          form.style.backgroundImage = selectedThemeColor;
          form.style.backgroundColor = "";
        } else {
          form.style.backgroundColor = selectedThemeColor;
        }
        cancelSelectedThemeColor();
      }
    }
    function cancelSelectedThemeColor() {
      selectedThemeColor = null;
      document.getElementById('themeColorPreviewArea').style.display = 'none';
      document.getElementById('themeColorActionButtons').style.display = 'none';
      document.querySelectorAll('#colorSubDropdown .thumbnail-bar div').forEach(div => div.style.borderColor = 'transparent');
    }
    // Global click to cancel preview if clicked outside preview areas (for mood and style)
    document.addEventListener('click', function(event) {
      if(!event.target.closest('#moodPreviewArea') && !event.target.closest('#moodActionButtons') && !event.target.closest('#moodSubDropdown button')){
        document.getElementById('moodPreviewArea').style.display = 'none';
        document.getElementById('moodActionButtons').style.display = 'none';
      }
      if(!event.target.closest('#stylePreviewArea') && !event.target.closest('#styleActionButtons') && !event.target.closest('#styleSubDropdown button')){
        document.getElementById('stylePreviewArea').style.display = 'none';
        document.getElementById('styleActionButtons').style.display = 'none';
      }
    });
  </script>
</body>
</html>
