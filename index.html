<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Business Card Generator</title>
    <!-- Font Awesome -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      rel="stylesheet"
    />
    <!-- intl-tel-input CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css"
    />
    <!-- Quill CSS -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet" />
    <style>
      :root {
        --primary-color: #2c3e50;
        --secondary-color: #3498db;
        --accent-color: #e74c3c;
        --neutral-light: rgba(236, 240, 241, 0.9);
        --neutral-dark: #34495e;
        --background-color: #ffffff;
      }
      body {
        font-family: 'Segoe UI', sans-serif;
        margin: 0;
        padding: 1rem;
        background: var(--background-color);
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        transition: background 0.3s ease;
      }
      .form-container {
        width: 100%;
        max-width: 450px;
        background: #fff;
        border-radius: 15px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        padding: 1.5rem;
        position: relative;
        box-sizing: border-box;
        margin-bottom: 20px;
      }
      /* Top gear icon */
      .gear-icon {
        position: absolute;
        top: -10px;
        right: 1rem;
        font-size: 1.5rem;
        color: var(--primary-color);
        cursor: pointer;
        transition: transform 0.3s ease;
      }
      .gear-icon:hover {
        transform: rotate(90deg);
        color: var(--secondary-color);
      }
      .form-header {
        text-align: center;
        color: var(--primary-color);
        margin-bottom: 1.5rem;
      }
      .form-grid {
        display: grid;
        gap: 1rem;
        margin-bottom: 1.5rem;
      }
      /* Profile Section for basic info */
      .profile-section-form {
        display: grid;
        gap: 1rem;
      }
      .input-group {
        display: flex;
        flex-direction: column;
        gap: 0.3rem;
      }
      .input-group label {
        font-weight: 600;
        color: var(--neutral-dark);
      }
      .input-group .required {
        color: var(--accent-color);
      }
      input,
      select,
      textarea {
        width: 100%;
        padding: 0.7rem;
        border: 1px solid var(--neutral-light);
        border-radius: 6px;
        font-size: 0.9rem;
        box-sizing: border-box;
        transition: border-color 0.2s ease;
      }
      input:focus,
      select:focus,
      textarea:focus {
        border-color: var(--secondary-color);
        outline: none;
      }
      textarea {
        resize: vertical;
      }
      .error {
        border: 2px solid var(--accent-color);
      }
      .image-upload-group {
        text-align: center;
        border: 2px dashed var(--neutral-light);
        padding: 1rem;
        border-radius: 8px;
        cursor: pointer;
      }
      #imagePreview {
        width: 50px;
        height: 50px;
        border-radius: 4px;
        object-fit: cover;
        margin: 0.5rem auto;
        display: none;
      }
      #generateCard {
        background: var(--secondary-color);
        color: #fff;
        width: 100%;
        padding: 0.8rem;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-size: 1rem;
      }
      /* Countdown style */
      .counter {
        font-size: 0.8rem;
        color: #555;
      }
      /* Dropdown (gear) */
      .dropdown-menu {
        display: none;
        position: absolute;
        top: 2rem;
        right: -20px;
        background: #fff;
        border: 1px solid var(--neutral-light);
        border-radius: 8px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
        padding: 0.5rem;
        width: 80px;
        z-index: 1000;
        text-align: center;
      }
      .dropdown-menu.active {
        display: block;
      }
      .dropdown-menu h4,
      .dropdown-menu button {
        font-size: 0.8rem;
        margin: 0.2rem 0;
        background: var(--secondary-color);
        color: #fff;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }
      /* New "Just for you" Section (copied from carousel.html) */
      .just-for-you-section {
        border: 1px solid var(--neutral-light);
        border-radius: 8px;
        padding: 1rem;
        background: #f9f9f9;
      }
      .just-for-you-section h3 {
        margin-bottom: 0.5rem;
        color: var(--primary-color);
      }
      .just-for-you-section p {
        font-size: 0.9rem;
        color: var(--neutral-dark);
      }
      /* Edit Card Section (moved inside the main form) */
      #editForm {
        border: 1px solid var(--neutral-light);
        border-radius: 8px;
        padding: 1rem;
        background: #f5f5f5;
        margin-bottom: 1rem;
      }
      #editForm h3 {
        margin-bottom: 0.5rem;
        font-size: 1rem;
        color: var(--primary-color);
      }
      #editForm label {
        font-size: 0.9rem;
      }
      #editForm input,
      #editForm textarea,
      #editForm select {
        font-size: 0.9rem;
      }
      /* Banner field group */
      .banner-field-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        margin-bottom: 1rem;
        position: relative;
      }
      .banner-field {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .banner-field input {
        flex: 1;
        padding: 0.5rem;
        border: 1px solid var(--neutral-light);
        border-radius: 4px;
      }
      .banner-field button {
        background: var(--secondary-color);
        color: #fff;
        border: none;
        border-radius: 4px;
        padding: 0.5rem;
        cursor: pointer;
      }
      .banner-dropdown {
        position: absolute;
        top: -2.2rem;
        left: 0;
        background: #fff;
        border: 1px solid var(--neutral-light);
        border-radius: 4px;
        box-shadow: 0 8px 30px rgba(0,0,0,0.3);
        padding: 0.5rem;
        width: 250px;
        display: none;
        z-index: 999;
      }
      .banner-dropdown button {
        width: 100%;
        padding: 0.3rem;
        margin: 0.2rem 0;
        background: #fff;
        border: 1px solid var(--neutral-light);
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.8rem;
      }
      /* Offer Fields */
      .offer-field {
        border: 1px solid var(--neutral-light);
        border-radius: 6px;
        padding: 0.5rem;
        margin-bottom: 0.8rem;
      }
      .offer-field-row {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .offer-field-row input[type="text"] {
        flex: 1;
      }
      .offer-field-row button {
        background: var(--secondary-color);
        color: #fff;
        border: none;
        border-radius: 4px;
        padding: 0.4rem 0.7rem;
        cursor: pointer;
      }
      .offer-details {
        margin-top: 0.5rem;
        border-top: 1px dashed var(--neutral-light);
        padding-top: 0.5rem;
        display: none;
      }
      .offer-editor {
        height: 120px;
        background: #fff;
        border: 1px solid var(--neutral-light);
        border-radius: 4px;
      }
      .offer-details .close-offer-details {
        margin-top: 0.5rem;
        background: var(--accent-color);
        color: #fff;
        border: none;
        border-radius: 4px;
        padding: 0.4rem 0.7rem;
        cursor: pointer;
      }
      /* Offer Style Selection */
      .offer-style-selection {
        text-align: center;
        margin-top: 1rem;
        position: relative;
      }
      #offerStyleBtn {
        background: var(--secondary-color);
        color: #fff;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        position: relative;
      }
      #offerStyleBtn::after {
        content: "\f0d7";
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
      }
      .offer-style-dropdown {
        display: none;
        position: absolute;
        top: calc(100% + 0.5rem);
        left: 50%;
        transform: translateX(-50%);
        background: #fff;
        border: 1px solid var(--neutral-light);
        border-radius: 4px;
        box-shadow: 0 8px 30px rgba(0,0,0,0.3);
        padding: 0.5rem;
        width: 150px;
        z-index: 1000;
        text-align: center;
      }
      .offer-style-dropdown button {
        width: 100%;
        padding: 0.3rem;
        margin: 0.2rem 0;
        background: #fff;
        color: var(--secondary-color);
        border: 1px solid var(--neutral-light);
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.8rem;
        transition: transform 0.1s ease;
      }
      .offer-style-dropdown button:hover {
        transform: translateY(-2px);
      }
      #offerPreview {
        margin-top: 0.8rem;
        border: 1px dashed var(--neutral-light);
        padding: 0.5rem;
        min-height: 80px;
      }
      #applyOfferStyleBtn {
        margin-top: 0.5rem;
        background: var(--secondary-color);
        color: #fff;
        border: none;
        padding: 0.4rem 0.8rem;
        border-radius: 4px;
        cursor: pointer;
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="form-container" id="formContainer">
      <!-- Gear Icon -->
      <div class="gear-icon" onclick="toggleDropdown()">
        <i class="fas fa-cog"></i>
      </div>
      <!-- Dropdown Menu -->
      <div class="dropdown-menu" id="dropdownMenu">
        <h4 onclick="toggleSubDropdown('mood')">Mood</h4>
        <div id="moodSubDropdown" class="sub-dropdown">
          <button onclick="previewMood('day')">Day</button>
          <button onclick="previewMood('night')">Night</button>
          <div class="action-buttons">
            <button onclick="applyMood()">Apply</button>
          </div>
        </div>
        <h4 onclick="toggleSubDropdown('theme')">Theme</h4>
        <div id="themeSubDropdown" class="sub-dropdown">
          <button onclick="previewTheme('default')">Default</button>
          <button onclick="toggleSubDropdown('image')">Image</button>
          <div id="imageSubDropdown" class="sub-dropdown">
            <div class="image-thumbnails">
              <img src="https://cdn.pixabay.com/photo/2015/04/23/22/00/tree-736885_1280.jpg" alt="Image 1" onclick="previewTheme('image', this.src)">
              <img src="https://cdn.pixabay.com/photo/2015/12/01/20/28/road-1072821_1280.jpg" alt="Image 2" onclick="previewTheme('image', this.src)">
              <img src="https://cdn.pixabay.com/photo/2016/05/05/02/37/sunset-1373171_1280.jpg" alt="Image 3" onclick="previewTheme('image', this.src)">
              <img src="https://cdn.pixabay.com/photo/2018/08/21/23/29/forest-3622519_1280.jpg" alt="Image 4" onclick="previewTheme('image', this.src)">
              <img src="https://cdn.pixabay.com/photo/2017/02/08/17/24/fantasy-2049567_1280.jpg" alt="Image 5" onclick="previewTheme('image', this.src)">
            </div>
          </div>
          <button onclick="toggleSubDropdown('color')">Color</button>
          <div id="colorSubDropdown" class="sub-dropdown">
            <div class="color-thumbnails">
              <div style="background-color: #3498db;" onclick="previewTheme('color', '#3498db')"></div>
              <div style="background-color: #e74c3c;" onclick="previewTheme('color', '#e74c3c')"></div>
              <div style="background-color: #2ecc71;" onclick="previewTheme('color', '#2ecc71')"></div>
              <div style="background-color: #9b59b6;" onclick="previewTheme('color', '#9b59b6')"></div>
              <div style="background-color: #f1c40f;" onclick="previewTheme('color', '#f1c40f')"></div>
            </div>
          </div>
          <div class="action-buttons">
            <button onclick="applyTheme()">Apply</button>
          </div>
        </div>
        <h4 onclick="toggleSubDropdown('style')">Style</h4>
        <div id="styleSubDropdown" class="sub-dropdown">
          <button onclick="previewStyle('accordion'); closeOfferStyleDropdown()">Accordion</button>
          <button onclick="previewStyle('horizontal'); closeOfferStyleDropdown()">Horizontal</button>
          <button onclick="previewStyle('tab'); closeOfferStyleDropdown()">Tab-based</button>
          <button onclick="previewStyle('modal'); closeOfferStyleDropdown()">Modal Popup</button>
          <div class="action-buttons">
            <button onclick="applyStyle()">Apply</button>
          </div>
        </div>
      </div>
      <!-- Form Header -->
      <div class="form-header">
        <h2>Create Business Card</h2>
        <p>Fill in all required information</p>
      </div>
      <div class="form-grid">
        <!-- Profile Section: image upload and basic info -->
        <div class="profile-section-form">
          <div class="image-upload-group">
            <label for="profileImage">
              <i class="fas fa-camera fa-2x"></i>
              <p>Upload Profile Photo</p>
            </label>
            <input type="file" id="profileImage" accept="image/*" onchange="previewImage(event)" />
            <img id="imagePreview" alt="Profile Preview" />
          </div>
          <div class="input-group">
            <label for="name">Full Name <span class="required">*</span></label>
            <input type="text" id="name" placeholder="Full Name" required />
          </div>
          <div class="input-group">
            <label for="businessName">Business Name <span class="required">*</span></label>
            <input type="text" id="businessName" placeholder="Business Name" required />
          </div>
        </div>
        <!-- New "Just for you" section (from carousel.html) -->
        <div class="just-for-you-section">
          <h3>Just for you</h3>
          <p>This section is specially curated to provide personalized recommendations and content—exclusively for you!</p>
        </div>
        <!-- Additional fields -->
        <div class="input-group">
          <label for="address">Business Address <span class="required">*</span></label>
          <input type="text" id="address" placeholder="Business Address" required />
        </div>
        <div class="input-group">
          <label for="phone">Phone Number <span class="required">*</span></label>
          <input type="tel" id="phone" placeholder="Enter phone number" required />
        </div>
        <div class="input-group">
          <label for="email">Email Address <span class="required">*</span></label>
          <input type="email" id="email" placeholder="Email Address" required pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" title="Please enter a valid email address." />
        </div>
        <div class="input-group">
          <label for="facebook">Facebook URL</label>
          <input type="url" id="facebook" placeholder="Facebook URL" pattern="https?://(www\.)?facebook\.com/.*" title="Please enter a valid Facebook URL." />
        </div>
        <div class="input-group">
          <label for="instagram">Instagram URL</label>
          <input type="url" id="instagram" placeholder="Instagram URL" pattern="https?://(www\.)?instagram\.com/.*" title="Please enter a valid Instagram URL." />
        </div>
        <div class="input-group">
          <label for="youtube">YouTube URL</label>
          <input type="url" id="youtube" placeholder="YouTube URL" pattern="https?://(www\.)?youtube\.com/.*" title="Please enter a valid YouTube URL." />
        </div>
        <!-- Edit Card Section (moved from below Generate Card to above the Exclusive Offers section) -->
        <form id="editForm">
          <h3>Edit Card</h3>
          <label for="cardSelect">Select Card:</label>
          <select id="cardSelect">
            <option value="1">Card 1</option>
            <option value="2">Card 2</option>
            <option value="3">Card 3</option>
            <option value="4">Card 4</option>
          </select>
          <label for="newTitle">Title (max 10 words):</label>
          <input type="text" id="newTitle" placeholder="Enter new title" required />
          <div class="counter" id="titleCounter">10 words remaining</div>
          <label for="newDesc">Description (max 50 words):</label>
          <textarea id="newDesc" rows="3" placeholder="Enter new description" required></textarea>
          <div class="counter" id="descCounter">50 words remaining</div>
          <label for="newDetails">Details (max 100 words):</label>
          <textarea id="newDetails" rows="3" placeholder="Enter card details" required></textarea>
          <div class="counter" id="detailsCounter">100 words remaining</div>
          <label for="newImage">Upload New Image (optional):</label>
          <input type="file" id="newImage" accept="image/*" />
          <label for="imgPosition">Image Position:</label>
          <select id="imgPosition">
            <option value="right" selected>Right</option>
            <option value="left">Left</option>
          </select>
          <button type="submit">Update Card</button>
        </form>
        <!-- Exclusive Offers Section -->
        <div class="exclusive-offers-section">
          <div class="banner-field-group">
            <label for="offerBanner">Initial Banner Text</label>
            <div class="banner-field">
              <input type="text" id="offerBanner" value="Grab your exclusive offers now!" />
              <button type="button" onclick="toggleBannerDropdown('banner1Dropdown')">Options</button>
            </div>
            <div class="banner-dropdown" id="banner1Dropdown">
              <button type="button" onclick="setBannerText('offerBanner','Discover unbeatable deals today!')">
                Discover unbeatable deals today!
              </button>
              <button type="button" onclick="setBannerText('offerBanner','Unlock premium offers instantly!')">
                Unlock premium offers instantly!
              </button>
              <button type="button" onclick="setBannerText('offerBanner','Experience exclusive savings now!')">
                Experience exclusive savings now!
              </button>
            </div>
            <label for="offerBannerClicked">On-Click Banner Text</label>
            <div class="banner-field">
              <input type="text" id="offerBannerClicked" value="Visit our store now!" />
              <button type="button" onclick="toggleBannerDropdown('banner2Dropdown')">Options</button>
            </div>
            <div class="banner-dropdown" id="banner2Dropdown">
              <button type="button" onclick="setBannerText('offerBannerClicked','Step into our store for exclusive deals!')">
                Step into our store for exclusive deals!
              </button>
              <button type="button" onclick="setBannerText('offerBannerClicked','Your next big saving awaits!')">
                Your next big saving awaits!
              </button>
              <button type="button" onclick="setBannerText('offerBannerClicked','Don’t miss our premium offers!')">
                Don’t miss our premium offers!
              </button>
            </div>
          </div>
          <h3>Exclusive Offers</h3>
          <div id="offersContainer">
            <div class="offer-field" id="offerField1">
              <div class="offer-field-row">
                <input type="text" id="offerTitle1" placeholder="Offer 1 Title" />
                <button type="button" onclick="toggleOfferDetails(1)">Details</button>
              </div>
              <div class="offer-details" id="offerDetailsContainer1">
                <div id="offerEditor1" class="offer-editor"></div>
                <textarea id="offerText1" name="offerText1" style="display:none;"></textarea>
                <input type="file" id="offerFile1" accept="image/*" onchange="previewOfferFile(event,1)" />
                <img id="offerFilePreview1" src="" alt="Offer File Preview" style="display:none; width:50px; height:50px; margin-top:5px;" />
                <br />
                <button type="button" class="close-offer-details" onclick="saveAndCloseOfferDetails(1)">
                  Save &amp; Close
                </button>
              </div>
            </div>
            <div class="offer-field" id="offerField2">
              <div class="offer-field-row">
                <input type="text" id="offerTitle2" placeholder="Offer 2 Title" />
                <button type="button" onclick="toggleOfferDetails(2)">Details</button>
              </div>
              <div class="offer-details" id="offerDetailsContainer2">
                <div id="offerEditor2" class="offer-editor"></div>
                <textarea id="offerText2" name="offerText2" style="display:none;"></textarea>
                <input type="file" id="offerFile2" accept="image/*" onchange="previewOfferFile(event,2)" />
                <img id="offerFilePreview2" src="" alt="Offer File Preview" style="display:none; width:50px; height:50px; margin-top:5px;" />
                <br />
                <button type="button" class="close-offer-details" onclick="saveAndCloseOfferDetails(2)">
                  Save &amp; Close
                </button>
              </div>
            </div>
            <div class="offer-field" id="offerField3">
              <div class="offer-field-row">
                <input type="text" id="offerTitle3" placeholder="Offer 3 Title" />
                <button type="button" onclick="toggleOfferDetails(3)">Details</button>
              </div>
              <div class="offer-details" id="offerDetailsContainer3">
                <div id="offerEditor3" class="offer-editor"></div>
                <textarea id="offerText3" name="offerText3" style="display:none;"></textarea>
                <input type="file" id="offerFile3" accept="image/*" onchange="previewOfferFile(event,3)" />
                <img id="offerFilePreview3" src="" alt="Offer File Preview" style="display:none; width:50px; height:50px; margin-top:5px;" />
                <br />
                <button type="button" class="close-offer-details" onclick="saveAndCloseOfferDetails(3)">
                  Save &amp; Close
                </button>
              </div>
            </div>
            <div class="offer-field" id="offerField4">
              <div class="offer-field-row">
                <input type="text" id="offerTitle4" placeholder="Offer 4 Title" />
                <button type="button" onclick="toggleOfferDetails(4)">Details</button>
              </div>
              <div class="offer-details" id="offerDetailsContainer4">
                <div id="offerEditor4" class="offer-editor"></div>
                <textarea id="offerText4" name="offerText4" style="display:none;"></textarea>
                <input type="file" id="offerFile4" accept="image/*" onchange="previewOfferFile(event,4)" />
                <img id="offerFilePreview4" src="" alt="Offer File Preview" style="display:none; width:50px; height:50px; margin-top:5px;" />
                <br />
                <button type="button" class="close-offer-details" onclick="saveAndCloseOfferDetails(4)">
                  Save &amp; Close
                </button>
              </div>
            </div>
          </div>
          <div class="offer-style-selection">
            <button type="button" id="offerStyleBtn" onclick="toggleOfferStyleDropdown()">
              Select Offer Style
            </button>
            <div class="offer-style-dropdown" id="offerStyleDropdown">
              <button type="button" onclick="selectOfferStyle('accordion')">Accordion</button>
              <button type="button" onclick="selectOfferStyle('horizontal')">Horizontal</button>
              <button type="button" onclick="selectOfferStyle('tab')">Tab-based</button>
              <button type="button" onclick="selectOfferStyle('modal')">Modal Popup</button>
            </div>
            <div id="offerPreview"></div>
            <button type="button" id="applyOfferStyleBtn" onclick="applyStyle()">Apply Offer Style</button>
          </div>
        </div>
        <!-- Generate Card Button -->
        <button id="generateCard">Generate Card</button>
      </div>
      
      <!-- Modal for Card Details (shifted from carousel.html) -->
      <div class="modal" id="detailsModal">
        <div class="modal-content">
          <button class="close-btn">&times;</button>
          <div id="modalBody">
            <!-- Details will be injected here -->
          </div>
        </div>
      </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js"></script>
    <script>
      // Firebase config (replace placeholders)
      var firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_AUTH_DOMAIN",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_STORAGE_BUCKET",
        messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
        appId: "YOUR_APP_ID"
      };
      firebase.initializeApp(firebaseConfig);
      
      var phoneInput = document.querySelector("#phone");
      var iti = window.intlTelInput(phoneInput, {
        initialCountry: "auto",
        separateDialCode: true,
        geoIpLookup: function(success, failure) {
          fetch("https://ipinfo.io/json?token=YOUR_TOKEN")
            .then(resp => resp.json())
            .then(data => success(data.country))
            .catch(() => success("us"));
        },
        utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js"
      });
      
      function previewImage(event) {
        const reader = new FileReader();
        const preview = document.getElementById("imagePreview");
        reader.onload = function(e) { preview.src = e.target.result; preview.style.display = "block"; };
        reader.readAsDataURL(event.target.files[0]);
      }
      
      // Banner dropdown functions
      function toggleBannerDropdown(id) {
        const dd = document.getElementById(id);
        dd.style.display = (dd.style.display === "block") ? "none" : "block";
      }
      function setBannerText(fieldId, text) {
        document.getElementById(fieldId).value = text;
        if (fieldId === "offerBanner")
          document.getElementById("banner1Dropdown").style.display = "none";
        else
          document.getElementById("banner2Dropdown").style.display = "none";
      }
      
      // Offer details functions
      window.offerEditors = {};
      function toggleOfferDetails(index) {
        const container = document.getElementById("offerDetailsContainer" + index);
        container.style.display = (container.style.display === "block") ? "none" : "block";
        if (container.style.display === "block" && !window.offerEditors[index]) {
          window.offerEditors[index] = new Quill("#offerEditor" + index, {
            theme: "snow",
            modules: {
              toolbar: [
                [{ font: [] }, { size: [] }],
                ["bold", "italic", "underline"],
                [{ color: [] }, { background: [] }],
                [{ align: [] }],
                ["clean"]
              ]
            }
          });
        }
      }
      function previewOfferFile(event, index) {
        const reader = new FileReader();
        const preview = document.getElementById("offerFilePreview" + index);
        reader.onload = function(e) { preview.src = e.target.result; preview.style.display = "block"; };
        reader.readAsDataURL(event.target.files[0]);
      }
      function saveAndCloseOfferDetails(index) {
        if (window.offerEditors[index]) {
          document.getElementById("offerText" + index).value = window.offerEditors[index].root.innerHTML;
        }
        document.getElementById("offerDetailsContainer" + index).style.display = "none";
      }
      // Offer style preview dropdown
      function toggleOfferStyleDropdown() {
        const dd = document.getElementById("offerStyleDropdown");
        dd.style.display = (dd.style.display === "block") ? "none" : "block";
      }
      function closeOfferStyleDropdown() {
        document.getElementById("offerStyleDropdown").style.display = "none";
      }
      var selectedOfferStyle = "";
      function selectOfferStyle(style) {
        selectedOfferStyle = style;
        showOfferPreview(style);
        closeOfferStyleDropdown();
        document.getElementById("applyOfferStyleBtn").style.display = "inline-block";
      }
      function showOfferPreview(style) {
        const previewDiv = document.getElementById("offerPreview");
        if (style === "accordion")
          previewDiv.innerHTML =
            '<div style="border:1px solid #ccc; padding:10px;">Accordion Preview<br/><em>Click header to expand details.</em></div>';
        else if (style === "horizontal")
          previewDiv.innerHTML =
            '<div style="overflow-x:auto; white-space:nowrap; border:1px solid #ccc; padding:10px;">' +
            '<div style="display:inline-block; width:25vw; height:25vw; background:#3498db; margin-right:5px; color:#fff; text-align:center;">Horizontal Preview</div>' +
            '</div>';
        else if (style === "tab")
          previewDiv.innerHTML =
            '<div style="border:1px solid #ccc; padding:10px;">Tab-based Preview</div>';
        else if (style === "modal")
          previewDiv.innerHTML =
            '<div style="border:1px solid #ccc; padding:10px;">Modal Popup Preview</div>';
      }
      function applyStyle() {
        alert("Offer style " + selectedOfferStyle + " applied!");
      }
      
      // Generate Card functionality – on click, gather form data, store it, and redirect
      document.getElementById("generateCard").addEventListener("click", function (e) {
        e.preventDefault();
        const formData = {
          profileImage: document.getElementById("imagePreview").src,
          name: document.getElementById("name").value,
          businessName: document.getElementById("businessName").value,
          address: document.getElementById("address").value,
          phone: document.getElementById("phone").value,
          email: document.getElementById("email").value,
          facebook: document.getElementById("facebook").value,
          instagram: document.getElementById("instagram").value,
          youtube: document.getElementById("youtube").value
          // You can add further fields (including offers) as needed
        };
        localStorage.setItem("formData", JSON.stringify(formData));
        window.location.href = "card.html";
      });
      
      // (Optional: Code for carousel auto-slide if needed – omitted if not in this design)
      
      // Modal functionality for card details (if any card is clicked)
      const modal = document.getElementById("detailsModal");
      const modalBody = document.getElementById("modalBody");
      const closeBtn = document.querySelector(".close-btn");
      document.querySelectorAll(".card").forEach(function (card) {
        card.addEventListener("click", function (e) {
          if (
            e.target.classList.contains("upload-btn") ||
            e.target.classList.contains("details-btn")
          )
            return;
          const detailsText = this.getAttribute("data-details") || "No details available.";
          modalBody.innerHTML = `<h3>Card ${this.getAttribute("data-card")} Details</h3><p>${detailsText}</p>`;
          modal.style.display = "flex";
        });
      });
      document.querySelectorAll(".details-btn").forEach(function (btn) {
        btn.addEventListener("click", function (e) {
          e.stopPropagation();
          const card = this.closest(".card");
          const detailsText = card.getAttribute("data-details") || "No details available.";
          modalBody.innerHTML = `<h3>Card ${card.getAttribute("data-card")} Details</h3><p>${detailsText}</p>`;
          modal.style.display = "flex";
        });
      });
      if (closeBtn) {
        closeBtn.addEventListener("click", function () {
          modal.style.display = "none";
        });
      }
      window.addEventListener("click", function (e) {
        if (e.target === modal) modal.style.display = "none";
      });
      
      // Edit Form word count limits
      const TITLE_LIMIT = 10;
      const DESC_LIMIT = 50;
      const DETAILS_LIMIT = 100;
      function updateCounter(field, counter, limit) {
        const words = field.value.trim().split(/\s+/).filter(function (word) {
          return word.length > 0;
        });
        counter.textContent = (limit - words.length) + " words remaining";
      }
      document.getElementById("newTitle").addEventListener("input", function () {
        updateCounter(this, document.getElementById("titleCounter"), TITLE_LIMIT);
      });
      document.getElementById("newDesc").addEventListener("input", function () {
        updateCounter(this, document.getElementById("descCounter"), DESC_LIMIT);
      });
      document.getElementById("newDetails").addEventListener("input", function () {
        updateCounter(this, document.getElementById("detailsCounter"), DETAILS_LIMIT);
      });
    </script>
  </body>
</html>
